<!doctype html>
<html lang="">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>

  <!-- Disable tap highlight on IE -->
  <meta name="msapplication-tap-highlight" content="no">

  <!-- Web Application Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Web Starter Kit">
  <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Web Starter Kit">
  <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">

  <!-- Tile icon for Win8 (144x144 + tile color) -->
  <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
  <meta name="msapplication-TileColor" content="#2F3BA2">

  <!-- Color the status bar on mobile devices -->
  <meta name="theme-color" content="#2F3BA2">

  <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
  <!--
  <link rel="canonical" href="http://www.example.com/">
  -->

  <!--<link rel="stylesheet" href="styles/main.scss">-->

  <!-- Material Design icons -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

  <!--<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.cyan-light_blue.min.css">-->
  <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.brown-blue.min.css"/>

  <!-- Your styles -->
  <!--<link rel="stylesheet" href="styles/main.scss">-->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-min.js"></script>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    #map {
      height: 100%;
    }
  </style>

</head>
<body>
<!-- Add your site or app content here -->

<!-- BEGIN ------------------------------------------------------------->

<div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout__title">Neighborhood Map</span>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <header class="mdl-layout__header">
      <div class="mdl-layout__header-row">
        <span class="mdl-layout__title">Pizzerias</span>
      </div>
    </header>
    <div>
      <form action="#">
        <div class="mdl-textfield mdl-js-textfield">
          <input class="mdl-textfield__input" type="text" id="sample1">
          <label class="mdl-textfield__label" for="sample1">Filter</label>
        </div>
      </form>
    </div>

    <nav class="mdl-navigation" data-bind="foreach: locations">
      <a class="mdl-navigation__link" href="#">
        <li class="mdl-list__item mdl-list__item--three-line">
        <span class="mdl-list__item-primary-content">
          <!--<i class="material-icons mdl-list__item-avatar">person</i>-->
          <span data-bind="text: name"></span>
          <span data-bind="text: $parent.getStreetAddress($data)" class="mdl-list__item-text-body"></span>
        </span>
        </li>
      </a>
    </nav>
  </div>
  <main class="mdl-layout__content" id="map"></main>
</div>

<!-- END ------------------------------------------------------------->

<!-- build:js(app/) ../../scripts/main.min.js -->
<script src="./styles/src/mdlComponentHandler.js"></script>
<script src="./styles/src/button/button.js"></script>
<script src="./styles/src/checkbox/checkbox.js"></script>
<script src="./styles/src/icon-toggle/icon-toggle.js"></script>
<script src="./styles/src/menu/menu.js"></script>
<script src="./styles/src/progress/progress.js"></script>
<script src="./styles/src/radio/radio.js"></script>
<script src="./styles/src/slider/slider.js"></script>
<script src="./styles/src/spinner/spinner.js"></script>
<script src="./styles/src/switch/switch.js"></script>
<script src="./styles/src/tabs/tabs.js"></script>
<script src="./styles/src/textfield/textfield.js"></script>
<script src="./styles/src/tooltip/tooltip.js"></script>
<script src="./styles/src/layout/layout.js"></script>
<script src="./styles/src/data-table/data-table.js"></script>
<script src="./styles/src/ripple/ripple.js"></script>
<script src="scripts/ko-list.js"></script>
<script src="scripts/main.js"></script>
<!-- endbuild -->

<script>
  // Note: This example requires that you consent to location sharing when
  // prompted by your browser. If you see the error "The Geolocation service
  // failed.", it means you probably did not give permission for the browser to
  // locate you.

  function initMap() {
    var map = new google.maps.Map(document.getElementById('map'), {
//      center: {lat: locationsModel.locations()[0].lat, lng: locationsModel.locations()[0]},
      zoom: 11
    });

    var infoWindow = new google.maps.InfoWindow({map: map});
    infoWindow.close();

    // Try HTML5 geolocation.
    if (navigator.geolocation) {
      locationsModel.locations().forEach(function (elem) {
        navigator.geolocation.getCurrentPosition(function (position) {
          var marker = 0;
          var markers = [];

          marker = new google.maps.Marker({
            position: {lat: elem.lat, lng: elem.lng},
            map: map,
            title: elem.name,
            draggable: false,
            animation: google.maps.Animation.DROP
          });

          function toggleBounce() {
            if (marker.getAnimation() != null) {
              marker.setAnimation(null);
            } else {
              marker.setAnimation(google.maps.Animation.BOUNCE);
            }
          }

          google.maps.event.addListener(marker, 'click', function () {
            toggleBounce();
            infoWindow.setContent(elem.name);
            infoWindow.open(map, marker);
            setTimeout(toggleBounce, 2850);
          });

          markers.push(marker);


          // infoWindow.setPosition(marker.position);
          // infoWindow.setContent('Location found.');
          map.setCenter(marker.position);
        });
      }, function () {
        infoWindow.open();
        handleLocationError(true, infoWindow, map.getCenter());
      });
    } else {
      // Browser doesn't support Geolocation
      infoWindow().open();
      handleLocationError(false, infoWindow, map.getCenter());
    }
  }

  function handleLocationError(browserHasGeolocation, infoWindow, pos) {
    infoWindow.setPosition(pos);
    infoWindow.setContent(browserHasGeolocation ?
      'Error: The Geolocation service failed.' :
      'Error: Your browser doesn\'t support geolocation.');
  }
</script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA6B4Ho8hb4k0xx6lYhC_uVl944Kcju3T0&callback=initMap">
</script>

<!-- Google Analytics: change UA-XXXXX-X to be your site's ID -->
<script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
    a = s.createElement(o),
      m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
  })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-XXXXX-X', 'auto');
  ga('send', 'pageview');
</script>
<!-- Built with love using Web Starter Kit -->
</body>
</html>
